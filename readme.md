## 项目简介
数学炮弹乐园：一个适合儿童的 0~20 以内加减法练习网页游戏。公式从顶部缓慢飘落，玩家输入正确答案并发射“炮弹”消灭公式，落地会扣生命。支持电脑与手机浏览器。

## 游戏规则
1. 生命值：初始 10 颗心，公式落地扣 1，归零则游戏结束。  
2. 命中：输入答案回车或点“发射”，子弹命中后公式原地爆炸无闪烁。  
3. 等级：共 20 级。  
   - 1~10 级：两个数字的加减法（结果保持在 0~20）。  
   - 11~15 级：三个数字加减。  
   - 16~20 级：四个数字加减。  
   难度通过缩短下落时间和生成间隔逐步提升。  
4. 子弹：速度按等级缓慢增加，命中逻辑优化减少卡顿。  
5. 通关：超过第 20 级即胜利，显示胜利遮罩，可重新开始。  

## 主要特性
- 支持移动端（自适应布局 + 数字输入模式）。
- 心形生命条与儿童友好配色。
- 命中爆炸动画自实现（避免 CSS 动画导致位置跳闪）。
- 性能优化：降低布局读取频率、translate3d 硬件加速。
- 保证所有题目结果在 0~20 范围，适合心算训练。
- 扩展性：等级参数集中在 `game.js` 的 `levelConfig` 中可继续调整。

## 文件结构
- `index.html` 炮弹落下模式页面
- `shooting.html` 数字射击模式页面（新增）
- `style.css` 公共样式与两种模式的动画
- `game.js` 炮弹落下模式逻辑
- `shooting.js` 数字射击模式逻辑（新增）
- `wrangler.toml` Cloudflare Pages 部署配置
- `readme.md` 项目说明
- `audio/` 目录：包含或放置 `hit.mp3`, `miss.mp3`, `level.mp3` （命中 / 失误 / 升级，可自定义替换）

## 本地运行
直接双击或拖拽 `index.html` 到浏览器打开即可，无需构建。

### Node.js 本地开发 (可选)
使用内置 Express 服务器方便在本地模拟部署环境与添加后端接口。

```bash
npm install        # 安装依赖 (已执行过可跳过)
npm run dev        # 开发模式: 自动重启
# 或
npm start          # 生产/普通启动
```

启动后访问: http://localhost:3000

## Cloudflare Pages 部署

### 方法一：控制台部署（推荐）
1. 推送代码到 GitHub / Gitee 等仓库。
2. 登录 Cloudflare，进入 Pages 创建新项目。
3. 选择仓库。
4. 构建设置：
   - Build command：留空
   - Output directory：.
5. 保存部署，首次构建完成后获得公开访问链接。

### 方法二：Wrangler CLI 部署
1. 安装依赖（若未安装 node）:
   ```
   npm install -D wrangler
   ```
2. 登录：
   ```
   npx wrangler login
   ```
3. 部署当前目录到 Pages：
   ```
   npx wrangler pages deploy . --project-name math-arithmetic-game
   ```
4. 若首次执行会自动创建项目，后续更改直接再次 deploy。

### 可自定义
编辑 `wrangler.toml` 可增加：
```toml
# 示例
# [vars]
# SOME_FLAG = "1"
```

## 二次开发提示
- 调整等级节奏：修改 `levelConfig` 中的 `minDuration / maxDuration / spawnInterval / operands`。
- 可添加音效：在命中、落地、升级时插入 `<audio>` 或 Web Audio。
- 若要增加乘除法：扩展表达式生成逻辑，注意结果仍需限制 0~20。
- 可加入排行榜：增加后端或使用 KV/Workers 储存分数。

## 数字射击模式（新增）
1. 场地内同时出现 5 个靶子，每个靶子显示一个结果在 0~20 之间的加减法公式。  
2. 输入答案后回车或点“射击”命中则该靶子落下并立即补新靶子，得分 = 命中次数。  
3. 初始总时间 180 秒；首次命中开始倒计时。每次升级（命中满 10 次）自动增加 20 秒剩余时间并刷新 HUD。  
4. 等级共 10 级，升级提升操作数或最大数字范围（结果仍限制 0~20）：  
   - Level 1~3：2 个数字，最大值 10  
   - Level 4~6：3 个数字，最大值 20（3 数公式字体自动缩小并居中）  
   - Level 7~10：4 个数字，最大值 20（4 数公式进一步缩小并居中）  
5. HUD 显示：等级、当前等级命中进度(已命中/10)、动态总时间(随升级 +20s)、得分。  
6. 答错仅提示“答错”不扣分；所有公式结果保持在 0~20 便于心算。  
7. 命中 / 失误 / 升级播放音效（与炮弹模式共用 `audio/` 目录）。  
8. 靶子为纯圆形（移除立杆/底座）提升布局适配与清晰度。  

## 使用说明（新增模式）
- 打开 `shooting.html` 进入数字射击计时 + 动态延长模式（初始 180s，升级 +20s）。  
- 音效：文件放入 `audio/` 目录 (默认 `hit.mp3` / `miss.mp3` / `level.mp3`)，可替换自定义声音。  
- 调整等级策略：修改 `shooting.js` 中 `getConfig(level)` 的 operands / maxNum。  
- 调整每级命中需求：修改常量 `LEVEL_TARGET`。  
- 调整初始时间与升级加时：修改 `totalTime` 初始值与 `EXTRA_PER_LEVEL`。  
- 若需取消不重叠逻辑可简化 `createTarget()` 中的定位循环。  

## License
本游戏示例用于教学与练习，可自由复制修改。若用于商业请自行优化与测试。
